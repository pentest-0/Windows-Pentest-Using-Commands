
Notes: need to go back to "psexec in page 53-59"
==========================================================================
==========================================================================
WMIC = Windows Management Instrumentation Control command 

==========================================================================
------------------------------
Localgroup & Domain Accounts -
------------------------------
#list the accounts on the machine with:
  net user

#accounts are in the administrators group by running:
  net localgroup administrators

#create new account with password:
  net user test Abcd@1234 /add

#Reset a password for test user:
  net user test *

#add a the user into the local administrators group using this command: 
  net localgroup administrators test /add

#check the users add in the administrators group by running the following command:
  net localgroup administrators

#pipe the output of that command through the find command looking for "test":
  net localgroup administrators | find "test"

#run other shell by the test user name with the following command: 
  runas /u:test cmd.exe

----------------------------------------------------------------------------------

----------
Cleanup  -
----------
#delete the user from the local administrators group:
  net localgroup administrators test /add

#delete the user account
  net user test /del

----------------------------------------------------------------------------------

---------------
Network Usage -
---------------
#Find file shares on machine:
  net view \\127.0.0.1

#Find who has an open session with the machine:
  net session  

#Look at which sessions this machine has opened with other systems:
  net user

#Look at NetBIOS over TCP/IP activity:
 nbtstat -s

#Look for unusual listening TCP and UDP ports:
  netstat -an

#For continuously updated and scrolling output of this command every 5 seconds:
  netstat -na 5

#The –o flag shows the owning process id:
  netstat -nao 5

#The –b flag shows the executable name and the DLLs loaded for the network connection.
  netstat -naob 5

#Look for usage of a port for every [n] seconds:
  netstat -nao [N] | find [port]

#dump detailed protocl statistics:
  netstat -s -p [tcp|udp|ip|icmp]

-----------------------------------------------------------------------------------

------------------------------------
 Processes and Services Management -
------------------------------------
Look for unusual/unexpected processes, and focus on processes with User Name “SYSTEM” or “Administrator” (or users in the
Administrators' group:

#list all processes currently running applications and services with their Process ID (PID) for all tasks running on a local or a remote computer.
  tasklist

#list all processes currently running and the DLLs each has loaded:
  tasklist /m

#list all processes currently running which have the specified [dll] loaded:
  tasklist /m [dll]

#query brief status of all services:
  sc query

#query the configuration of a specific service:
  sc qc [service name]
-----
WIMC-
-----
#display a list of processes:
 wmic process list full

#make WIMC effect remote [target IP add]:
  wimc /node:192.168.1.1 /user:john /password:abc123 process list full

-------------------------------------------------------------------------------

---------------------
Firewall & Security -
---------------------
#Also check Windows Firewall configuration:
  netsh firewall show config

#turn off built-in windows firewall:
  netsh firewall set opmode disable








